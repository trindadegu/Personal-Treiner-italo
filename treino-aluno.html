<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Meu Treino - Acessoria Atlântida">
    <title>Meu Treino - Acessoria Atlântida</title>
    <link rel="icon" type="image/png" href="img/acessoriaab.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body class="page-aluno">

    <!-- Header -->
    <header class="student-header">
        <div class="header-container-aluno">
            <div class="header-logo">
                <div class="logo-img-container">
                    <img src="img/acessoriaar.png" alt="Logo Acessoria Atlântida" class="logo-img-aluno" id="logoImage">
                </div>
                <div class="header-info-aluno">
                    <h1 id="studentName">Carregando...</h1>
                </div>
            </div>
            <div class="header-actions">
                <button class="theme-toggle-aluno" data-action="toggle-theme" title="Alternar tema">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
                <button class="menu-hamburger" data-action="toggle-days-menu" id="menuToggle">
                    <i class="fas fa-calendar-alt" id="menuIcon"></i>
                    <span id="currentDayText">Seg</span>
                </button>
                <button class="btn-header" data-action="logout" title="Sair do sistema">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Sair</span>
                </button>
            </div>
        </div>
    </header>

    <div class="menu-overlay" data-action="close-days-menu" id="menuOverlay"></div>

    <!-- Days Menu -->
    <div class="days-menu-mobile" id="daysMenuMobile">
        <div class="days-menu-content">
            <div class="days-grid-mobile" id="daysGridMobile">
                <button class="day-btn-mobile active" data-day="segunda">Segunda</button>
                <button class="day-btn-mobile" data-day="terca">Terça</button>
                <button class="day-btn-mobile" data-day="quarta">Quarta</button>
                <button class="day-btn-mobile" data-day="quinta">Quinta</button>
                <button class="day-btn-mobile" data-day="sexta">Sexta</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-container">

        <!-- Progress -->
        <section class="progress-section">
            <div class="progress-header">
                <h3><i class="fas fa-chart-line"></i> Progresso do Dia</h3>
                <div class="progress-percentage" id="progressPercentage">0%</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">0 / 0 exercícios completos</div>
        </section>

        <!-- ============================== CHECK-IN CARD ============================== -->
        <section class="checkin-card-aluno" id="checkinCard">
            <div class="checkin-card-top">
                <div class="checkin-card-title">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Fazer Check-in na Academia</span>
                </div>
                <!-- Badge com status do último check-in -->
                <div class="checkin-badge" id="checkinBadge" style="display:none;"></div>
            </div>

            <p class="checkin-card-desc">
                Registre sua presença! Vamos encontrar a academia mais próxima de você e avisar seu professor.
            </p>

            <!-- Último check-in info -->
            <div class="checkin-last-info" id="checkinLastInfo" style="display:none;">
                <i class="fas fa-history"></i>
                <span id="checkinLastText">Último check-in: —</span>
            </div>

            <!-- Botão principal -->
            <button class="btn-checkin" id="btnCheckin" data-action="do-checkin">
                <i class="fas fa-map-pin"></i>
                <span>Fazer Check-in agora</span>
            </button>

            <!-- Loading state -->
            <div class="checkin-loading" id="checkinLoading" style="display:none;">
                <i class="fas fa-spinner fa-spin"></i>
                <span id="checkinLoadingText">Obtendo localização...</span>
            </div>

            <!-- Resultado do check-in -->
            <div class="checkin-result" id="checkinResult" style="display:none;">
                <div class="checkin-result-gym">
                    <i class="fas fa-dumbbell checkin-result-icon"></i>
                    <div>
                        <div class="checkin-result-name" id="checkinGymName">—</div>
                        <div class="checkin-result-address" id="checkinGymAddress">—</div>
                        <div class="checkin-result-dist" id="checkinGymDist">—</div>
                    </div>
                </div>
                <!-- Mini mapa no card -->
                <div id="checkinMiniMap" class="checkin-mini-map"></div>
            </div>
        </section>
        <!-- ============================== FIM CHECK-IN CARD ============================== -->

        <!-- Training Content -->
        <section class="training-content">
            <div class="training-header">
                <h2 id="dayTitle"><i class="fas fa-calendar-day"></i> Segunda-feira</h2>
                <div class="focus-area" id="focusArea">Carregando...</div>
            </div>
            <div class="exercises-container">
                <table class="exercises-table-aluno">
                    <thead>
                        <tr>
                            <th width="5%"></th>
                            <th width="45%">Exercício</th>
                            <th width="15%">Séries</th>
                            <th width="15%">Repetições</th>
                            <th width="20%">Vídeo</th>
                        </tr>
                    </thead>
                    <tbody id="exercisesTableBody">
                        <tr>
                            <td colspan="5" style="text-align:center;padding:2rem;color:var(--gray-text);">
                                <i class="fas fa-spinner fa-spin" style="font-size:1.5rem;margin-bottom:.5rem;"></i><br>Carregando exercícios...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- WhatsApp Flutuante -->
    <div class="whatsapp-float" data-action="send-whatsapp" title="Pedir ajuda pelo WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </div>

    <div id="toastContainer"></div>
    <script src="treino-aluno.js"></script>
</body>
</html>